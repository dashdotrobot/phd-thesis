\providecommand{\rootdir}{../..}
\documentclass[\rootdir/thesis.tex]{subfiles}

\begin{document}

We can easily obtain approximate solutions to \eqref{eq:EulerLagrange} of arbitrary accuracy while preserving the full details of coupling between $u,v,w,\phi$ by the Rayleigh-Ritz method. Rather than requiring that the first variation of the total potential \eqref{eq:TotPot} be precisely zero, we construct convenient approximations to the deformation variables $u,v,w,\phi$ and minimize the total potential.

We approximate the deformation variables with a finite Fourier series:
\begin{align}
\label{eq:mm_FourierDef}
u &= u_0 + \sum_{n=1}{N} u_n^c \cos{n\theta} + u_n^s \sin{n\theta}\\
v &= v_0 + \sum_{n=1}{N} v_n^c \cos{n\theta} + v_n^s \sin{n\theta}\\
w &= w_0 + \sum_{n=1}{N} w_n^c \cos{n\theta} + w_n^s \sin{n\theta}\\
\phi &= \phi_0 + \sum_{n=1}{N} \phi_n^c \cos{n\theta} + \phi_n^s \sin{n\theta}
\end{align}

Increasing the maximum mode number $N$ results in higher accuracy. The deformation mode coefficients are collected into a single vector of length $4+8N$:
\begin{equation}
\mathbf{d} = [u_0,v_0,w_0,\phi_0,u_1^c,u_1^s,v_1^c,v_1^s,w_1^c,w_1^s,\phi_1^c,\phi_1^s,u_2^c,u_2^s,\dots]^T
\end{equation}

The displacement vector $[u,v,w,\phi]$ at a point $\theta$ is given by
\begin{equation}
\label{eq:u_Bd}
\mathbf{u} = \mathbf{B}(\theta)\mathbf{d}
\end{equation}

where
\begin{equation}
\setcounter{MaxMatrixCols}{16}
\mathbf{B}(\theta) =
\begin{bmatrix}
1 & 0 & 0 & 0 & c\theta & s\theta & 0 & 0 & 0 & 0 & 0 & 0 & c2\theta & s2\theta & \dots\\
0 & 1 & 0 & 0 & 0 & 0 & c\theta & s\theta & 0 & 0 & 0 & 0 & 0 & 0 & \dots\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & c\theta & s\theta & 0 & 0 & 0 & 0 & \dots\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & c\theta & s\theta & 0 & 0 & \dots
\end{bmatrix}
\end{equation}

where $c\theta=\cos{\theta}, s\theta=\sin{\theta}$, etc.

Inserting the series approximations \eqref{eq:mm_FourierDef} into \eqref{eq:U_rim} and \eqref{eq:V_rim} and integrating yields a quadratic form for the strain energy and virtual work of internal forces in the rim:
\begin{equation}
\label{eq:mm_U_rim}
\Pi_{rim} = \frac{1}{2} \mathbf{d}^T \mathbf{K}_{rim} \mathbf{d}
\end{equation}

where $\mathbf{K}_{rim}$ is the rim mode stiffness matrix. Since the Fourier basis functions are orthogonal on the unit circle, $\mathbf{K}_{rim}$ has the block diagonal structure:
\begin{equation}
\label{eq:mm_K_rim}
\mathbf{K}_{rim} =
\begin{bmatrix}
\mathbf{K}_0^{rim} & & &\\
& \mathbf{K}_1^{rim} & &\\
& & \ddots &\\
& & & \mathbf{K}_N^{rim}
\end{bmatrix}
\end{equation}

The zero-mode matrix is
\begin{equation}
\mathbf{K}_0^{rim} =
\begin{bmatrix}
0 & 0 & 0 & 0\\
0 & 2\pi \frac{EA}{R} & 0 & 0\\
0 & 0 & 0 & 0\\
0 & 0 & 0 & 2\pi \frac{EI_2}{R} + 2\pi R\bar{T}y_0
\end{bmatrix}
\end{equation}

The subsequent mode matrices take the form
\begin{equation}
\mathbf{K}_{n\geq 1}^{rim} =
\begin{bmatrix}
k_{uu} & 0 & 0 & 0 & 0 & 0 & -k_{u\phi} & 0\\
0 & k_{uu} & 0 & 0 & 0 & 0 & 0 & -k_{u\phi}\\
0 & 0 & k_{vv} & 0 & 0 & -k_{vw} & 0 & 0\\
0 & 0 & 0 & k_{vv} & k_{vw} & 0 & 0 & 0\\
0 & 0 & -k_{vw} & 0 & 0 & k_{ww} & 0 & 0\\
-k_{u\phi} & 0 & 0 & 0 & 0 & 0 & k_{\phi\phi} & 0\\
0 & -k_{u\phi} & 0 & 0 & 0 & 0 & 0 & k_{\phi\phi}
\end{bmatrix}
\end{equation}

\begin{align*}
k_{uu} &= \frac{\pi EI_2}{R^3}n^4 + \frac{\pi EI_w}{R^5}n^4 + \frac{\pi GJ}{R^3}n^2 - \pi n^2 \bar{T}\left(1 + \frac{r_y^2}{R^2}\right)\\
k_{vv} &= \frac{\pi EI_1}{R^3}n^4 + \frac{\pi EA}{R}\left(1 + \frac{y_0}{R}n^2 \right)^2\\
k_{ww} &= \frac{\pi EI_1}{R^3}n^2 + \frac{\pi EA n^2}{R}\left(1 + \frac{y_0}{R} \right)^2\\
k_{vw} &= \frac{\pi EI_1}{R^3}n^3 + \frac{\pi EA n}{R}\left(1 + \frac{y_0}{R}(1+n^2) + \frac{y_0^2}{R^2}n^2\right)\\
k_{\phi\phi} &= \frac{\pi EI_2}{R} + \frac{\pi EI_w}{R^3}n^4 + \frac{\pi GJ}{R}n^2 - \pi R^2\bar{T}\left(\frac{r_0^2}{R^2}-\frac{y_0}{R}\right)\\
k_{u\phi} &= \frac{\pi EI_2}{R^2}n^2 + \frac{\pi EI_w}{R^4}n^4 + \frac{\pi GJ}{R^2}n^2 - \pi n^2 R \bar{T}\left(\frac{y_0}{R}n^2 + \frac{r_y^2}{R^2}\right)
\end{align*}

Inserting \eqref{eq:u_Bd} into \eqref{eq:U_spokes_discrete} yields the strain energy stored in the spokes:
\begin{align}
\label{eq:mm_U_spokes}
\begin{split}
U_{spokes} &= \frac{1}{2} \sum_{i=1}^{n_s} \mathbf{u}^T(\theta_i) \cdot \mathbf{k}_{s,i} \cdot \mathbf{u}(\theta)\\
&= \frac{1}{2} \sum_{i=1}^{n_s} \mathbf{d}^T \left(\mathbf{B}_i^T\mathbf{k}_{s, i}\mathbf{B}_i \right)\mathbf{d}\\
&= \frac{1}{2} \mathbf{d}^T \left(\sum_{i=1}^{n_s} \mathbf{B}_i^T\mathbf{k}_{s, i}\mathbf{B}_i \right) \mathbf{d}\\
&= \frac{1}{2} \mathbf{d}^T \mathbf{K}_{spokes} \mathbf{d}
\end{split}
\end{align}

Due the discrete nature of the spokes, the spoke stiffness matrix $\mathbf{K}_{spokes}$ has non-zero elements outside of the block diagonal shown in Equation \eqref{eq:mm_K_rim}. If, on the other hand, the smeared-spokes approximation to the strain energy \eqref{eq:U_spokes} is used, then the modes decouple and the strain energy is given by
\begin{equation}
\label{eq:U_spokes_smeared}
\bar{U}_{spokes} = \frac{1}{2} \mathbf{d}^T \bar{\mathbf{K}}_{spokes} \mathbf{d}
\end{equation}

where the zero-mode block (upper-left 4x4 matrix) is equal to $2\pi R\mathbf{\bar{k}}$. The remaining 8x8 blocks are given by the relation $\mathbf{\bar{K}}_{spokes}(2i-1, 2j-1) = \mathbf{\bar{K}}_{spokes}(2i, 2j) = \pi R \mathbf{\bar{k}}_{i,j}$.

If the external loads are given as a series of point loads (and couples), the virtual work of external loads is obtained in a straightforward manner:
\begin{align}
\label{eq:mm_F_ext}
\begin{split}
V_{ext} &= \sum_{i=1}^{n_f} f_{ext}^i \cdot \mathbf{u} \\
&= \sum_{i=1}^{n_f} f_{ext}^i \cdot \mathbf{B}(\theta_i)\mathbf{d}\\
&= \left(\sum_{i=1}^{n_f} f_{ext}^i \cdot \mathbf{B}(\theta_i) \right) \mathbf{d}\\
&= \mathbf{F}_{ext}\mathbf{d}
\end{split}
\end{align}

Combining Equations \eqref{eq:mm_U_rim}, \eqref{eq:mm_U_spokes}, and \eqref{eq:mm_F_ext}, the total potential energy is
\begin{equation}
\label{eq:mm_TotPot}
\Pi = \frac{1}{2} \mathbf{d}^T \left( \mathbf{K}_{rim} + \mathbf{K}_{spokes} \right) \mathbf{d} - \mathbf{F}_{ext}\mathbf{d}
\end{equation}

Minimizing the total potential energy \eqref{eq:mm_TotPot} with respect to the mode coefficients $\mathbf{d}$ yields the modal Rayleigh-Ritz equations:
\begin{equation}
\label{eq:mm_Kd_f}
\left( \mathbf{K}_{rim} + \mathbf{K}_{spokes} \right) \mathbf{d} = \mathbf{F}_{ext}
\end{equation}

Equation \eqref{eq:mm_Kd_f} suggests an analogy with the finite-element method, in which the displacement field is approximated with appropriately constructed shape functions which interpolate the displacements at discrete points throughout the body. By contrast, the mode-matrix method described here approximates the displacement field with a finite set of functions chosen such that the strain energy is approximately additively decomposed. If the smeared-spokes approximation, \eqref{eq:U_spokes_smeared}, is used, the stiffness matrix is guaranteed to have a sparse, block-diagonal form, while still retaining possible coupling (through the spoke geometry) between in-plane and out-of-plane deformations.

\end{document}
